<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Jogos do Dia de Sorte - Sistema Completo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dia-sorte': {
                            50: '#fcf9e8',
                            100: '#f9f2d2',
                            200: '#f4e5a4',
                            300: '#eed877',
                            400: '#e6c533',
                            500: '#d4b31a',
                            600: '#b69816',
                            700: '#887211',
                            800: '#5b4c0b',
                            900: '#2d2606'
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        :root {
            --primary-color: #d4b31a;
            --primary-dark: #9f8514;
            --secondary-color: #e6c533;
            --accent-color: #ccab19;
            --background-color: #fcf9e8;
            --table-header: #d4b31a;
            --table-border: #e3be1c;
            --table-even: #f9f2d2;
            --table-odd: #ffffff;
            --text-color: #2d2606;
            --footer-color: #715f0e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fcf9e8 0%, #f9f2d2 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        .logo {
            display: block;
            margin: auto;
            width: 350px;
            height: auto;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        .logo:hover {
            opacity: 1.0;
        }

        .number-ball {
            transition: all 0.3s ease;
        }
        .number-ball:hover:not(:disabled) {
            transform: scale(1.1);
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #d4b31a;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        .section-card {
            background: linear-gradient(135deg, #fcf9e8, #f9f2d2);
            border: 2px solid #D4B31A;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(212, 179, 26, 0.3);
        }

        .section-title {
            color: #D4B31A;
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 99999;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 10px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            border: 2px solid #D4B31A;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #555 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .logo {
                width: 280px;
            }
        }

        @media (max-width: 480px) {
            .logo {
                width: 220px;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <img src="https://i.postimg.cc/3R2PytCp/diadesorte.png" alt="Dia de Sorte Logo" class="logo mb-4">
            <h1 class="text-4xl font-bold text-dia-sorte-800 mb-2">Gerador de Jogos do Dia de Sorte</h1>
            <p class="text-dia-sorte-700 text-lg">Sistema Completo e Inteligente para Apostas Profissionais</p>
            <p class="text-dia-sorte-600 text-sm mt-2">Escolha seus n√∫meros ‚Ä¢ Configure estrat√©gias ‚Ä¢ Gere quantos jogos quiser</p>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="text-center py-8">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-dia-sorte-700">Carregando dados da API da Caixa...</p>
        </div>

        <!-- Main Content -->
        <div id="mainContent" class="hidden space-y-8">
            
            <!-- √öltimos Resultados Section -->
            <div class="section-card p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="section-title">
                        <i class="fas fa-trophy"></i> √öltimos 6 Concursos do Dia de Sorte
                    </h2>
                    <button id="toggleResultados" class="bg-dia-sorte-500 hover:bg-dia-sorte-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Mostrar
                    </button>
                </div>
                <div id="resultadosContent" class="hidden">
                    <div id="ultimosResultados" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Resultados ser√£o carregados aqui -->
                    </div>
                </div>
            </div>

            <!-- An√°lise Detalhada Section -->
            <div class="section-card p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="section-title">
                        <i class="fas fa-chart-bar"></i> An√°lise Detalhada dos Concursos
                    </h2>
                    <button id="toggleAnalise" class="bg-dia-sorte-500 hover:bg-dia-sorte-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Mostrar
                    </button>
                </div>
                <div id="analiseContent" class="hidden">
                    <!-- Filtros -->
                    <div class="bg-dia-sorte-50 rounded-lg p-4 mb-4 border border-dia-sorte-200">
                        <h3 class="text-lg font-semibold text-dia-sorte-800 mb-3">Filtros e Op√ß√µes</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- Ordena√ß√£o -->
                            <div>
                                <label class="block text-dia-sorte-700 font-medium mb-2">Ordena√ß√£o dos Concursos</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="radio" name="ordenacao" value="decrescente" checked class="mr-2 text-dia-sorte-500 focus:ring-dia-sorte-500">
                                        <span class="text-dia-sorte-700">Mais recentes primeiro</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="ordenacao" value="crescente" class="mr-2 text-dia-sorte-500 focus:ring-dia-sorte-500">
                                        <span class="text-dia-sorte-700">Mais antigos primeiro</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Quantidade -->
                            <div>
                                <label class="block text-dia-sorte-700 font-medium mb-2">Quantidade de Concursos</label>
                                <select id="quantidadeConcursos" class="w-full border border-dia-sorte-300 rounded-lg px-3 py-2 text-base bg-white focus:border-dia-sorte-500 focus:ring-2 focus:ring-dia-sorte-200">
                                    <option value="20">√öltimos 20</option>
                                    <option value="50">√öltimos 50</option>
                                    <option value="100">√öltimos 100</option>
                                    <option value="200">√öltimos 200</option>
                                    <option value="todos">Todos os concursos</option>
                                </select>
                            </div>

                            <!-- Bot√µes -->
                            <div class="flex flex-col justify-end space-y-2">
                                <button id="aplicarFiltros" class="bg-dia-sorte-500 hover:bg-dia-sorte-600 text-white px-4 py-2 rounded-lg transition-colors">
                                    <i class="fas fa-filter"></i> Aplicar Filtros
                                </button>
                                <button id="exportarCSV" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                                    <i class="fas fa-file-csv"></i> Exportar CSV
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Loading da tabela -->
                    <div id="loadingTabela" class="text-center py-8 hidden">
                        <div class="loading-spinner mx-auto mb-4"></div>
                        <p class="text-dia-sorte-700">Carregando an√°lise dos concursos...</p>
                    </div>

                    <!-- Tabela -->
                    <div id="containerTabela" class="overflow-x-auto">
                        <table class="w-full text-xs border-collapse border border-dia-sorte-300">
                            <thead>
                                <tr class="bg-dia-sorte-500 text-white">
                                    <th class="border border-dia-sorte-300 p-2 text-center">Concurso</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Data</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Dezenas</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">M√™s</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Padr√£o In√≠cio</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Padr√£o Final</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">D√≠gitos √önicos</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Qtd D√≠gitos</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Pares</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">√çmpares</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">Soma</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">N√£o Sa√≠ram</th>
                                    <th class="border border-dia-sorte-300 p-2 text-center">A√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaAnaliseBody">
                                <!-- Ser√° preenchido dinamicamente -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Info de resultados -->
                    <div id="infoResultados" class="mt-4 text-center text-dia-sorte-700">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o de Sele√ß√£o de N√∫meros -->
            <div class="section-card p-6">
                <h2 class="section-title mb-6">
                    <i class="fas fa-mouse-pointer"></i> Escolha seus N√∫meros da Sorte
                </h2>
                
                <!-- N√∫meros do √∫ltimo sorteio -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-amber-800">
                            <i class="fas fa-exclamation-triangle"></i> N√∫meros do √öltimo Sorteio
                        </h4>
                        <label class="flex items-center">
                            <input type="checkbox" id="usarUltimoSorteio" class="mr-2 text-dia-sorte-500 focus:ring-dia-sorte-500">
                            <span class="text-sm text-amber-700">Permitir usar esses n√∫meros</span>
                        </label>
                    </div>
                    <div id="numerosUltimoSorteio" class="flex flex-wrap gap-2 mb-3">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                    <p class="text-xs text-amber-600">
                        Por padr√£o, estes n√∫meros est√£o desabilitados. Marque a op√ß√£o acima para habilit√°-los.
                    </p>
                </div>

                <!-- Grid de n√∫meros -->
                <div class="mb-6">
                    <div class="text-center mb-4">
                        <p class="text-dia-sorte-700 font-semibold">Selecione de 7 a 15 n√∫meros (01 a 31)</p>
                        <p id="selectedCount" class="text-dia-sorte-600">Selecionados: <span class="font-bold text-dia-sorte-500">0</span>/15 <span class="text-sm">(m√≠nimo: 7)</span></p>
                    </div>
                    
                    <div class="grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 lg:grid-cols-16 gap-2 max-w-4xl mx-auto mb-4" id="numerosGrid">
                        <!-- N√∫meros ser√£o gerados dinamicamente -->
                    </div>
                    
                    <!-- Mensagens din√¢micas -->
                    <div id="mensagemSelecao" class="hidden p-3 rounded-lg mb-4">
                        <!-- Mensagens aparecer√£o aqui -->
                    </div>
                    
                    <!-- Controles -->
                    <div class="text-center space-x-2 mb-4">
                        <button id="limparSelecao" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-eraser"></i> Limpar
                        </button>
                        <button id="selecaoAleatoria" class="bg-dia-sorte-500 hover:bg-dia-sorte-600 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-dice"></i> Sele√ß√£o Aleat√≥ria
                        </button>
                        <button id="usarResultado" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors hidden">
                            <i class="fas fa-trophy"></i> Usar √öltimo Resultado
                        </button>
                    </div>

                    <!-- Tabela de pre√ßos -->
                    <div class="bg-dia-sorte-50 rounded-lg p-4 border border-dia-sorte-200">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="font-semibold text-dia-sorte-800">
                                <i class="fas fa-dollar-sign"></i> Tabela de Pre√ßos por Quantidade
                            </h4>
                            <div class="flex items-center space-x-2">
                                <label class="text-sm text-dia-sorte-700">Valor base (7 n√∫meros):</label>
                                <input type="number" step="0.01" id="basePrice" value="2.50" 
                                       class="w-20 border border-dia-sorte-300 rounded px-2 py-1 text-sm text-center text-base"
                                       onchange="updateAllPrices()" onkeyup="updateAllPrices()">
                                <button onclick="resetBasePrice()" class="bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded text-xs transition-colors" title="Restaurar valor padr√£o">
                                    <i class="fas fa-undo"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-3 md:grid-cols-5 lg:grid-cols-9 gap-2 text-xs text-center" id="pricesDisplay">
                            <div class="bg-white p-2 rounded border"><strong>7 ‚Üí</strong><br><span id="price-7">R$ 2,50</span></div>
                            <div class="bg-white p-2 rounded border"><strong>8 ‚Üí</strong><br><span id="price-8">R$ 20,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>9 ‚Üí</strong><br><span id="price-9">R$ 90,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>10 ‚Üí</strong><br><span id="price-10">R$ 300,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>11 ‚Üí</strong><br><span id="price-11">R$ 825,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>12 ‚Üí</strong><br><span id="price-12">R$ 1.980,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>13 ‚Üí</strong><br><span id="price-13">R$ 4.290,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>14 ‚Üí</strong><br><span id="price-14">R$ 8.580,00</span></div>
                            <div class="bg-white p-2 rounded border"><strong>15 ‚Üí</strong><br><span id="price-15">R$ 16.087,50</span></div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <p class="text-xs text-dia-sorte-600">
                                <i class="fas fa-info-circle"></i> Valores calculados automaticamente baseado no pre√ßo de 7 n√∫meros
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Configura√ß√µes de Gera√ß√£o -->
            <div class="section-card p-6">
                <h2 class="section-title mb-6">
                    <i class="fas fa-cogs"></i> Configura√ß√µes dos Jogos
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-6 mb-6">
                    <!-- Quantidade de Jogos -->
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 text-center">
                        <label class="block text-dia-sorte-700 font-semibold mb-2">
                            <i class="fas fa-list-ol"></i> Quantidade de Jogos
                        </label>
                        <input type="number" id="quantidadeJogos" min="1" value="5" 
                               class="w-full border border-dia-sorte-300 rounded-lg px-3 py-2 text-center font-bold bg-dia-sorte-50 focus:border-dia-sorte-500 focus:ring-2 focus:ring-dia-sorte-200"
                               onchange="updateTotalValue()">
                        <span class="tooltip"><i class="fas fa-info-circle text-dia-sorte-500"></i>
                            <span class="tooltiptext">N√∫mero de jogos diferentes que ser√£o gerados</span>
                        </span>
                    </div>

                    <!-- N√∫meros por Jogo -->
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 text-center">
                        <label class="block text-dia-sorte-700 font-semibold mb-2">
                            <i class="fas fa-hashtag"></i> N√∫meros por Jogo
                        </label>
                        <select id="numerosPorJogo" onchange="updateTotalValue()"
                                class="w-full border border-dia-sorte-300 rounded-lg px-3 py-2 text-center font-bold bg-dia-sorte-50 focus:border-dia-sorte-500 focus:ring-2 focus:ring-dia-sorte-200">
                            <option value="7">7 n√∫meros</option>
                            <option value="8">8 n√∫meros</option>
                            <option value="9">9 n√∫meros</option>
                            <option value="10">10 n√∫meros</option>
                            <option value="11">11 n√∫meros</option>
                            <option value="12">12 n√∫meros</option>
                            <option value="13">13 n√∫meros</option>
                            <option value="14">14 n√∫meros</option>
                            <option value="15">15 n√∫meros</option>
                        </select>
                        <span class="tooltip"><i class="fas fa-info-circle text-dia-sorte-500"></i>
                            <span class="tooltiptext">Quantidade de n√∫meros em cada jogo gerado</span>
                        </span>
                    </div>

                    <!-- Ajuste Progressivo -->
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 text-center">
                        <label class="block text-dia-sorte-700 font-semibold mb-2">
                            <i class="fas fa-chart-line"></i> Ajuste Progressivo
                        </label>
                        <select id="ajusteDezenas"
                                class="w-full border border-dia-sorte-300 rounded-lg px-3 py-2 text-center font-bold bg-dia-sorte-50 focus:border-dia-sorte-500 focus:ring-2 focus:ring-dia-sorte-200">
                            <option value="0">Sem Ajuste</option>
                            <option value="1" selected>+ 1</option>
                            <option value="2">+ 2</option>
                            <option value="3">+ 3</option>
                            <option value="-1">- 1</option>
                            <option value="-2">- 2</option>
                            <option value="-3">- 3</option>
                        </select>
                        <span class="tooltip"><i class="fas fa-info-circle text-dia-sorte-500"></i>
                            <span class="tooltiptext">Valor aplicado progressivamente aos n√∫meros</span>
                        </span>
                    </div>

                    <!-- Estrat√©gia -->
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 text-center">
                        <label class="block text-dia-sorte-700 font-semibold mb-2">
                            <i class="fas fa-brain"></i> Estrat√©gia
                        </label>
                        <select id="estrategia"
                                class="w-full border border-dia-sorte-300 rounded-lg px-3 py-2 text-center font-bold bg-dia-sorte-50 focus:border-dia-sorte-500 focus:ring-2 focus:ring-dia-sorte-200">
                            <option value="equilibrada">Equilibrada</option>
                            <option value="frequentes">Frequentes</option>
                            <option value="atrasados">Atrasados</option>
                            <option value="padrao">Por Padr√µes</option>
                        </select>
                        <span class="tooltip"><i class="fas fa-info-circle text-dia-sorte-500"></i>
                            <span class="tooltiptext">Estrat√©gia baseada em an√°lise estat√≠stica</span>
                        </span>
                    </div>

                    <!-- M√™s da Sorte -->
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 text-center">
                        <label class="block text-dia-sorte-700 font-semibold mb-2">
                            <i class="fas fa-calendar"></i> M√™s da Sorte
                        </label>
                        <select id="mesSorte"
                                class="w-full border border-dia-sorte-300 rounded-lg px-3 py-2 text-center font-bold bg-dia-sorte-50 focus:border-dia-sorte-500 focus:ring-2 focus:ring-dia-sorte-200">
                            <option value="">Aleat√≥rio</option>
                            <option value="Janeiro">Janeiro</option>
                            <option value="Fevereiro">Fevereiro</option>
                            <option value="Mar√ßo">Mar√ßo</option>
                            <option value="Abril">Abril</option>
                            <option value="Maio">Maio</option>
                            <option value="Junho">Junho</option>
                            <option value="Julho">Julho</option>
                            <option value="Agosto">Agosto</option>
                            <option value="Setembro">Setembro</option>
                            <option value="Outubro">Outubro</option>
                            <option value="Novembro">Novembro</option>
                            <option value="Dezembro">Dezembro</option>
                        </select>
                        <span class="tooltip"><i class="fas fa-info-circle text-dia-sorte-500"></i>
                            <span class="tooltiptext">M√™s da sorte para todos os jogos</span>
                        </span>
                    </div>

                    <!-- Evitar √öltimo Concurso -->
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 text-center">
                        <label class="block text-dia-sorte-700 font-semibold mb-2">
                            <i class="fas fa-shield-alt"></i> Evitar Repeti√ß√£o
                        </label>
                        <div class="flex items-center justify-center mt-3">
                            <input type="checkbox" id="evitarUltimoConcurso" class="mr-2 transform scale-150 text-dia-sorte-500 focus:ring-dia-sorte-500">
                            <label for="evitarUltimoConcurso" class="text-sm text-dia-sorte-700">N√£o usar dezenas<br>do √∫ltimo concurso</label>
                        </div>
                        <span class="tooltip"><i class="fas fa-info-circle text-dia-sorte-500"></i>
                            <span class="tooltiptext">Evita n√∫meros que sa√≠ram no √∫ltimo concurso</span>
                        </span>
                    </div>
                </div>
                
                <!-- Informa√ß√µes do Investimento -->
                <div class="text-center mb-6">
                    <div id="totalValueDisplay" class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 mb-4">
                        <div class="text-2xl font-bold text-dia-sorte-800 mb-2">
                            <i class="fas fa-calculator"></i> Investimento Total: R$ 12,50
                        </div>
                        <p class="text-dia-sorte-600">5 jogos √ó 7 n√∫meros √ó R$ 2,50 cada</p>
                    </div>
                    
                    <div id="digitsInfo" class="bg-dia-sorte-500 text-white rounded-lg p-3 mb-4 hidden">
                        <i class="fas fa-chart-bar"></i> <span id="digitsText">Aguardando sele√ß√£o...</span>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="text-center space-x-4">
                    <button id="generateBtn" onclick="gerarJogos()" disabled
                            class="bg-dia-sorte-500 hover:bg-dia-sorte-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 rounded-lg text-lg font-semibold transition-colors">
                        <i class="fas fa-magic"></i> Gerar Jogos
                    </button>
                    <button onclick="showInfoModal()" 
                            class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        <i class="fas fa-info-circle"></i> Como Funciona
                    </button>
                </div>
            </div>

            <!-- Se√ß√£o dos Jogos Gerados -->
            <div id="gamesSection" class="section-card p-6 hidden">
                <h2 class="section-title mb-6">
                    <i class="fas fa-list-ol"></i> Seus Jogos Gerados
                </h2>
                <div id="gamesContainer">
                    <!-- Jogos ser√£o inseridos aqui -->
                </div>
                
                <!-- Bot√µes de Download -->
                <div class="text-center mt-6 space-x-2 flex flex-wrap justify-center gap-2">
                    <button onclick="downloadTXT()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-file-alt"></i> Baixar TXT
                    </button>
                    <button onclick="downloadHTML()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-file-code"></i> Baixar HTML
                    </button>
                    <button onclick="downloadXLSX()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-file-excel"></i> Baixar XLSX
                    </button>
                    <button onclick="copiarJogos()" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-copy"></i> Copiar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dia-sorte-500 text-white py-6 mt-12">
        <div class="container mx-auto text-center">
            <p class="font-semibold">Sistema Completo de Apostas do Dia de Sorte</p>
            <p class="text-sm mt-2 opacity-90">Desenvolvido com tecnologia avan√ßada para apostadores profissionais</p>
            <p class="text-xs mt-2 opacity-75">Feito por: M√°rcio Fernando Maia - Todos os direitos reservados - 2025</p>
        </div>
    </footer>

    <script>
        // Global variables
        let dadosAPI = null;
        let numerosSelecionados = new Set();
        let ultimosConcursos = [];
        let todosConcursos = [];
        let generatedGames = [];

        // Frequ√™ncia hist√≥rica dos n√∫meros
        const frequenciaNumeros = {
            10: 283, 7: 271, 17: 267, 20: 266, 4: 263, 8: 261, 27: 261, 29: 260,
            11: 259, 9: 258, 24: 258, 6: 252, 23: 254, 21: 254, 18: 249, 5: 246,
            13: 242, 25: 241, 14: 243, 19: 243, 26: 243, 3: 240, 12: 238, 30: 236,
            22: 234, 2: 235, 15: 230, 16: 230, 28: 228, 1: 206, 31: 200
        };

        // Configura√ß√£o da API
        const API_CONFIG = {
            CAIXA_URL: 'https://servicebus2.caixa.gov.br/portaldeloterias/api/diadesorte',
            CORS_PROXY_URLS: [
                'https://api.allorigins.win/get?url=',
                'https://corsproxy.io/?'
            ]
        };

        // =================== INICIALIZA√á√ÉO ===================
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        async function initializeApp() {
            try {
                await carregarDadosAPI();
                criarGridNumeros();
                setupEventListeners();
                showMainContent();
            } catch (error) {
                console.error('Erro ao inicializar aplica√ß√£o:', error);
                showError('Erro ao carregar dados. Verifique sua conex√£o com a internet.');
            }
        }

        // =================== CARREGAMENTO DE DADOS ===================
        async function carregarDadosAPI() {
            try {
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/diadesorte');
                if (!response.ok) throw new Error('Erro na API');
                dadosAPI = await response.json();
                
                // Simular dados de concursos anteriores
                ultimosConcursos = [
                    { numero: dadosAPI.numero, data: dadosAPI.dataApuracao, dezenas: dadosAPI.listaDezenas, mes: dadosAPI.nomeTimeCoracaoMesSorte },
                    { numero: dadosAPI.numero - 1, data: "02/08/2025", dezenas: ["03", "11", "17", "25", "30", "05", "07"], mes: "Setembro" },
                    { numero: dadosAPI.numero - 2, data: "31/07/2025", dezenas: ["01", "06", "09", "23", "30", "31", "15"], mes: "Agosto" },
                    { numero: dadosAPI.numero - 3, data: "29/07/2025", dezenas: ["05", "15", "23", "14", "20", "11", "28"], mes: "Julho" },
                    { numero: dadosAPI.numero - 4, data: "26/07/2025", dezenas: ["10", "25", "27", "03", "18", "06", "29"], mes: "Junho" },
                    { numero: dadosAPI.numero - 5, data: "24/07/2025", dezenas: ["03", "05", "17", "21", "08", "24", "19"], mes: "Maio" }
                ];

                renderUltimosResultados();
                renderTabelaDetalhada();
            } catch (error) {
                console.error('Erro ao carregar dados da API:', error);
                // Usar dados simulados em caso de erro
                dadosAPI = {
                    numero: 1087,
                    dataApuracao: "05/01/2025",
                    listaDezenas: ["07", "12", "18", "23", "29", "31", "14"],
                    nomeTimeCoracaoMesSorte: "Janeiro"
                };
                
                ultimosConcursos = [
                    { numero: 1087, data: "05/01/2025", dezenas: ["07", "12", "18", "23", "29", "31", "14"], mes: "Janeiro" },
                    { numero: 1086, data: "02/01/2025", dezenas: ["03", "11", "17", "25", "30", "05", "07"], mes: "Dezembro" },
                    { numero: 1085, data: "31/12/2024", dezenas: ["01", "06", "09", "23", "30", "31", "15"], mes: "Novembro" },
                    { numero: 1084, data: "28/12/2024", dezenas: ["05", "15", "23", "14", "20", "11", "28"], mes: "Outubro" },
                    { numero: 1083, data: "26/12/2024", dezenas: ["10", "25", "27", "03", "18", "06", "29"], mes: "Setembro" },
                    { numero: 1082, data: "23/12/2024", dezenas: ["03", "05", "17", "21", "08", "24", "19"], mes: "Agosto" }
                ];

                renderUltimosResultados();
                renderTabelaDetalhada();
                showNotification('‚ö†Ô∏è Usando dados simulados (API indispon√≠vel)', 'info');
            }
        }

        function showMainContent() {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('mainContent').classList.remove('hidden');
        }

        function showError(message) {
            document.getElementById('loadingState').innerHTML = `
                <div class="text-center py-8">
                    <div class="text-red-500 text-xl mb-4">‚ö†Ô∏è</div>
                    <p class="text-red-600">${message}</p>
                </div>
            `;
        }

        // =================== GRID DE N√öMEROS ===================
        function criarGridNumeros() {
            const grid = document.getElementById('numerosGrid');
            grid.innerHTML = '';
            
            const numerosUltimoSorteio = dadosAPI.listaDezenas.map(d => parseInt(d));
            
            for (let i = 1; i <= 31; i++) {
                const button = document.createElement('button');
                button.id = `numero-${i}`;
                
                const isUltimoSorteio = numerosUltimoSorteio.includes(i);
                
                if (isUltimoSorteio) {
                    button.className = 'number-ball w-10 h-10 rounded-full border-2 border-red-400 bg-red-100 text-red-600 font-semibold text-sm transition-all cursor-not-allowed opacity-50 pulse-animation';
                    button.disabled = true;
                    button.title = 'N√∫mero do √∫ltimo sorteio - marque a op√ß√£o acima para habilitar';
                } else {
                    button.className = 'number-ball w-10 h-10 rounded-full border-2 border-dia-sorte-300 bg-white text-dia-sorte-700 font-semibold text-sm hover:bg-dia-sorte-500 hover:text-white hover:border-dia-sorte-500 transition-all cursor-pointer';
                }
                
                button.textContent = i.toString().padStart(2, '0');
                button.setAttribute('data-numero', i);
                button.addEventListener('click', () => toggleNumero(i));
                grid.appendChild(button);
            }
            
            renderNumerosUltimoSorteio();
        }

        function renderNumerosUltimoSorteio() {
            const container = document.getElementById('numerosUltimoSorteio');
            const numerosUltimoSorteio = dadosAPI.listaDezenas;
            
            container.innerHTML = numerosUltimoSorteio.map(numero => `
                <span class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold shadow-md">
                    ${numero}
                </span>
            `).join('');
        }

        function toggleNumero(numero) {
            const button = document.getElementById(`numero-${numero}`);
            
            if (!button) {
                console.error(`Bot√£o n√∫mero ${numero} n√£o encontrado`);
                return;
            }

            if (button.disabled) {
                mostrarMensagem('warning', 'Este n√∫mero saiu no √∫ltimo sorteio. Marque a op√ß√£o "Permitir usar esses n√∫meros" para habilit√°-lo.');
                return;
            }
            
            if (numerosSelecionados.has(numero)) {
                numerosSelecionados.delete(numero);
                button.classList.remove('bg-dia-sorte-500', 'text-white', 'border-dia-sorte-500');
                button.classList.add('border-dia-sorte-300', 'bg-white', 'text-dia-sorte-700');
            } else if (numerosSelecionados.size < 15) {
                numerosSelecionados.add(numero);
                button.classList.add('bg-dia-sorte-500', 'text-white', 'border-dia-sorte-500');
                button.classList.remove('border-dia-sorte-300', 'bg-white', 'text-dia-sorte-700');
                
                if (numerosSelecionados.size === 7) {
                    mostrarMensagem('success', 'üéâ Parab√©ns! Voc√™ selecionou 7 n√∫meros (m√≠nimo necess√°rio). Pode continuar selecionando at√© 15 n√∫meros para aumentar suas chances!');
                }
            } else {
                mostrarMensagem('warning', 'Limite m√°ximo de 15 n√∫meros atingido!');
                return;
            }
            
            updateSelectedCount();
            updateGenerateButton();
            updateDigitsInfo();
            updateTotalValue();
        }

        function updateSelectedCount() {
            const countSpan = document.querySelector('#selectedCount span');
            countSpan.textContent = numerosSelecionados.size;
        }

        function updateGenerateButton() {
            const btn = document.getElementById('generateBtn');
            btn.disabled = numerosSelecionados.size < 7;
        }

        function updateDigitsInfo() {
            const digitsDiv = document.getElementById('digitsInfo');
            const digitsText = document.getElementById('digitsText');
            
            if (numerosSelecionados.size > 0) {
                const digits = Array.from(numerosSelecionados).map(n => n.toString().slice(-1));
                const digitCount = {};
                
                digits.forEach(d => {
                    digitCount[d] = (digitCount[d] || 0) + 1;
                });
                
                const digitInfo = Object.entries(digitCount)
                    .map(([digit, count]) => `${digit}(${count}x)`)
                    .join(' ');
                
                digitsText.textContent = `D√≠gitos finais: ${digitInfo}`;
                digitsDiv.classList.remove('hidden');
            } else {
                digitsDiv.classList.add('hidden');
            }
        }

        function updateTotalValue() {
            const qtdJogos = parseInt(document.getElementById('quantidadeJogos').value) || 1;
            const numerosPorJogo = parseInt(document.getElementById('numerosPorJogo').value) || 7;
            const ajuste = parseInt(document.getElementById('ajusteDezenas').value) || 0;
            
            // Usar pre√ßos din√¢micos atualizados
            const precoPorJogo = precosAtuais[numerosPorJogo];
            const totalJogos = ajuste === 0 ? 1 : qtdJogos + 1; // 1 original + N ajustados
            const total = totalJogos * precoPorJogo;
            
            const totalDisplay = document.getElementById('totalValueDisplay');
            totalDisplay.innerHTML = `
                <div class="text-2xl font-bold text-dia-sorte-800 mb-2">
                    <i class="fas fa-calculator"></i> Investimento Total: ${formatarValor(total)}
                </div>
                <p class="text-dia-sorte-600">${totalJogos} jogos √ó ${numerosPorJogo} n√∫meros √ó ${formatarValor(precoPorJogo)} cada</p>
            `;
        }

        // =================== FUN√á√ïES DE CONTROLE ===================
        function setupEventListeners() {
            document.getElementById('toggleResultados').onclick = () => toggleSection('resultadosContent', 'toggleResultados');
            document.getElementById('toggleAnalise').onclick = () => toggleSection('analiseContent', 'toggleAnalise');
            
            document.getElementById('aplicarFiltros').onclick = aplicarFiltros;
            document.getElementById('exportarCSV').onclick = exportarCSV;
            
            document.getElementById('limparSelecao').onclick = limparSelecao;
            document.getElementById('selecaoAleatoria').onclick = selecaoAleatoria;
            
            document.getElementById('usarUltimoSorteio').onchange = toggleNumerosUltimoSorteio;
            
            // Configurar m√™s atual como padr√£o
            const mesAtual = new Date().getMonth();
            const meses = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 
                           'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            document.getElementById('mesSorte').value = meses[mesAtual];
        }

        function toggleSection(contentId, buttonId) {
            const content = document.getElementById(contentId);
            const button = document.getElementById(buttonId);
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                button.innerHTML = button.innerHTML.replace('Mostrar', 'Ocultar');
            } else {
                content.classList.add('hidden');
                button.innerHTML = button.innerHTML.replace('Ocultar', 'Mostrar');
            }
        }

        function limparSelecao() {
            numerosSelecionados.clear();
            
            for (let i = 1; i <= 31; i++) {
                const button = document.getElementById(`numero-${i}`);
                if (button && !button.disabled) {
                    button.classList.remove('bg-dia-sorte-500', 'text-white', 'border-dia-sorte-500');
                    button.classList.add('border-dia-sorte-300', 'bg-white', 'text-dia-sorte-700');
                }
            }
            
            updateSelectedCount();
            updateGenerateButton();
            updateDigitsInfo();
            updateTotalValue();
            mostrarMensagem('info', 'üßπ Sele√ß√£o limpa!');
        }

        function selecaoAleatoria() {
            limparSelecao();
            const numeros = Array.from({length: 31}, (_, i) => i + 1);
            
            for (let i = 0; i < 7; i++) {
                const randomIndex = Math.floor(Math.random() * numeros.length);
                const numero = numeros.splice(randomIndex, 1)[0];
                
                // Verificar se o n√∫mero n√£o est√° desabilitado
                const button = document.getElementById(`numero-${numero}`);
                if (button && !button.disabled) {
                    toggleNumero(numero);
                } else {
                    i--; // Tentar novamente
                }
            }
            
            mostrarMensagem('success', 'üé≤ N√∫meros selecionados aleatoriamente!');
        }

        function toggleNumerosUltimoSorteio() {
            const checkbox = document.getElementById('usarUltimoSorteio');
            const numerosUltimoSorteio = dadosAPI.listaDezenas.map(d => parseInt(d));
            const habilitado = checkbox.checked;
            
            numerosUltimoSorteio.forEach(numero => {
                const button = document.getElementById(`numero-${numero}`);
                if (button) {
                    if (habilitado) {
                        button.disabled = false;
                        button.className = 'number-ball w-10 h-10 rounded-full border-2 border-dia-sorte-300 bg-white text-dia-sorte-700 font-semibold text-sm hover:bg-dia-sorte-500 hover:text-white hover:border-dia-sorte-500 transition-all cursor-pointer';
                        button.title = '';
                    } else {
                        if (numerosSelecionados.has(numero)) {
                            numerosSelecionados.delete(numero);
                            updateSelectedCount();
                            updateGenerateButton();
                            updateDigitsInfo();
                            updateTotalValue();
                        }
                        button.disabled = true;
                        button.className = 'number-ball w-10 h-10 rounded-full border-2 border-red-400 bg-red-100 text-red-600 font-semibold text-sm transition-all cursor-not-allowed opacity-50 pulse-animation';
                        button.title = 'N√∫mero do √∫ltimo sorteio - marque a op√ß√£o acima para habilitar';
                    }
                }
            });
            
            if (habilitado) {
                mostrarMensagem('success', '‚úÖ N√∫meros do √∫ltimo sorteio habilitados! Agora voc√™ pode selecion√°-los.');
            } else {
                mostrarMensagem('info', '‚ÑπÔ∏è N√∫meros do √∫ltimo sorteio desabilitados novamente.');
            }
        }

        // =================== GERA√á√ÉO DE JOGOS ===================
        async function gerarJogos() {
            if (numerosSelecionados.size < 7) {
                mostrarMensagem('error', '‚ùå Selecione pelo menos 7 n√∫meros!');
                return;
            }
            
            const qtdJogos = parseInt(document.getElementById('quantidadeJogos').value);
            const numerosPorJogo = parseInt(document.getElementById('numerosPorJogo').value);
            const ajusteBase = parseInt(document.getElementById('ajusteDezenas').value);
            const estrategia = document.getElementById('estrategia').value;
            const mesSorte = document.getElementById('mesSorte').value;
            const evitarUltimoConcurso = document.getElementById('evitarUltimoConcurso').checked;
            
            // Modal de confirma√ß√£o para grandes quantidades
            if (qtdJogos > 1000) {
                const confirmed = await showConfirmDialog(
                    `‚ö†Ô∏è Voc√™ est√° prestes a gerar ${qtdJogos.toLocaleString()} jogos!\n\n` +
                    `Isso pode:\n` +
                    `‚Ä¢ Demorar alguns segundos para processar\n` +
                    `‚Ä¢ Consumir mais mem√≥ria do navegador\n` +
                    `‚Ä¢ Gerar arquivos grandes para download\n\n` +
                    `Deseja continuar?`
                );
                
                if (!confirmed) {
                    return;
                }
            }
            
            // Obter dezenas do √∫ltimo concurso para evitar
            let dezenasEvitar = [];
            if (evitarUltimoConcurso && ultimosConcursos.length > 0) {
                dezenasEvitar = ultimosConcursos[0].dezenas.map(d => parseInt(d));
            }
            
            generatedGames = [];
            let jogoCounter = 1;
            
            // Gerar jogo original
            const originalNumbers = Array.from(numerosSelecionados);
            const jogoOriginal = gerarJogoComEstrategia(originalNumbers, estrategia, numerosPorJogo, dezenasEvitar);
            
            generatedGames.push({
                jogo: jogoCounter++,
                tipo: 'original',
                numeros: jogoOriginal,
                mesSorte: mesSorte || gerarMesAleatorio()
            });
            
            // Gerar jogos ajustados se necess√°rio
            if (ajusteBase !== 0) {
                for (let i = 1; i <= qtdJogos; i++) {
                    const ajusteAtual = ajusteBase * i;
                    let gameNumbers = originalNumbers.map(num => {
                        let adjusted = num + ajusteAtual;
                        if (adjusted < 1) adjusted = 1;
                        if (adjusted > 31) adjusted = 31;
                        return adjusted;
                    });
                    
                    const jogoAjustado = gerarJogoComEstrategia(gameNumbers, estrategia, numerosPorJogo, dezenasEvitar);
                    
                    generatedGames.push({
                        jogo: jogoCounter++,
                        tipo: 'ajustado',
                        ajuste: ajusteAtual,
                        numeros: jogoAjustado,
                        mesSorte: mesSorte || gerarMesAleatorio()
                    });
                }
            }
            
            displayGeneratedGames();
            
            let successMessage = `‚úÖ ${generatedGames.length} jogos gerados com sucesso!`;
            if (evitarUltimoConcurso && dezenasEvitar.length > 0) {
                successMessage += ' (Evitando repeti√ß√µes do √∫ltimo concurso)';
            }
            
            mostrarMensagem('success', successMessage);
        }

        function gerarJogoComEstrategia(numerosBase, estrategia, numerosPorJogo, dezenasEvitar = []) {
            let jogo = [];
            
            // Usar n√∫meros base como ponto de partida
            if (numerosBase.length > 0) {
                const qtdBase = Math.min(numerosBase.length, Math.floor(numerosPorJogo * 0.7));
                jogo = [...numerosBase.slice(0, qtdBase)];
            }
            
            // Completar o jogo
            while (jogo.length < numerosPorJogo) {
                let novoNumero;
                
                switch (estrategia) {
                    case 'frequentes':
                        novoNumero = obterNumeroFrequente(jogo);
                        break;
                    case 'atrasados':
                        novoNumero = obterNumeroAtrasado(jogo);
                        break;
                    case 'padrao':
                        novoNumero = obterNumeroPorPadrao(jogo);
                        break;
                    default:
                        novoNumero = obterNumeroEquilibrado(jogo);
                }
                
                // Evitar n√∫meros do √∫ltimo concurso se necess√°rio
                if (dezenasEvitar.includes(novoNumero)) {
                    const alternativas = [novoNumero + 1, novoNumero - 1, novoNumero + 2, novoNumero - 2];
                    for (const alt of alternativas) {
                        if (alt >= 1 && alt <= 31 && !dezenasEvitar.includes(alt) && !jogo.includes(alt)) {
                            novoNumero = alt;
                            break;
                        }
                    }
                }
                
                if (!jogo.includes(novoNumero)) {
                    jogo.push(novoNumero);
                }
            }

            return jogo.sort((a, b) => a - b).map(n => n.toString().padStart(2, '0'));
        }

        function obterNumeroFrequente(jogoAtual) {
            const frequentes = Object.keys(frequenciaNumeros)
                .sort((a, b) => frequenciaNumeros[b] - frequenciaNumeros[a])
                .map(n => parseInt(n))
                .filter(n => !jogoAtual.includes(n));
            
            const topFrequentes = frequentes.slice(0, 10);
            return topFrequentes[Math.floor(Math.random() * topFrequentes.length)] || gerarNumeroAleatorio(jogoAtual);
        }

        function obterNumeroAtrasado(jogoAtual) {
            const atrasados = Object.keys(frequenciaNumeros)
                .sort((a, b) => frequenciaNumeros[a] - frequenciaNumeros[b])
                .map(n => parseInt(n))
                .filter(n => !jogoAtual.includes(n));
            
            const topAtrasados = atrasados.slice(0, 10);
            return topAtrasados[Math.floor(Math.random() * topAtrasados.length)] || gerarNumeroAleatorio(jogoAtual);
        }

        function obterNumeroPorPadrao(jogoAtual) {
            const padroes = [
                [1, 2, 3, 7, 9, 10, 11], 
                [4, 8, 17, 20, 24, 27, 29], 
                [31, 28, 16, 15, 22, 30, 12]
            ];
            
            const padraoEscolhido = padroes[Math.floor(Math.random() * padroes.length)];
            const numerosDisponiveis = padraoEscolhido.filter(n => !jogoAtual.includes(n));
            
            return numerosDisponiveis[Math.floor(Math.random() * numerosDisponiveis.length)] || gerarNumeroAleatorio(jogoAtual);
        }

        function obterNumeroEquilibrado(jogoAtual) {
            const todosNumeros = Object.keys(frequenciaNumeros).map(n => parseInt(n)).filter(n => !jogoAtual.includes(n));
            return todosNumeros[Math.floor(Math.random() * todosNumeros.length)] || gerarNumeroAleatorio(jogoAtual);
        }

        function gerarNumeroAleatorio(jogoAtual) {
            let numero;
            do {
                numero = Math.floor(Math.random() * 31) + 1;
            } while (jogoAtual.includes(numero));
            return numero;
        }

        function gerarMesAleatorio() {
            const meses = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            
            const frequenciaMeses = {
                'Novembro': 10.0, 'Fevereiro': 9.4, 'Abril': 9.3, 'Junho': 8.7,
                'Agosto': 8.5, 'Dezembro': 8.2, 'Mar√ßo': 8.0, 'Maio': 8.0,
                'Julho': 8.0, 'Outubro': 8.0, 'Janeiro': 7.3, 'Setembro': 6.8
            };

            const random = Math.random() * 100;
            let acumulado = 0;
            
            for (const [mes, freq] of Object.entries(frequenciaMeses)) {
                acumulado += freq;
                if (random <= acumulado) {
                    return mes;
                }
            }
            
            return meses[Math.floor(Math.random() * meses.length)];
        }

        // =================== EXIBI√á√ÉO DE JOGOS ===================
        function displayGeneratedGames() {
            const container = document.getElementById('gamesContainer');
            const section = document.getElementById('gamesSection');
            
            const numerosPorJogo = parseInt(document.getElementById('numerosPorJogo').value);
            const precos = {
                7: 2.50, 8: 20.00, 9: 90.00, 10: 300.00, 11: 825.00,
                12: 1980.00, 13: 4290.00, 14: 8580.00, 15: 16087.50
            };
            const precoPorJogo = precos[numerosPorJogo];
            const valorTotal = generatedGames.length * precoPorJogo;
            
            if (generatedGames.length > 5000) {
                container.innerHTML = `
                    <div class="text-center p-8 bg-white border-2 border-dia-sorte-300 rounded-lg">
                        <h3 class="text-2xl font-bold text-dia-sorte-800 mb-4">
                            üéÆ ${generatedGames.length.toLocaleString()} Jogos Gerados com Sucesso!
                        </h3>
                        <p class="text-dia-sorte-700 mb-4">
                            <strong>Devido √† grande quantidade, os jogos n√£o s√£o exibidos na tela para otimizar a performance.</strong>
                        </p>
                        <div class="bg-dia-sorte-100 border border-dia-sorte-300 rounded-lg p-4 mb-4">
                            <p class="text-lg font-bold text-dia-sorte-800 mb-2">
                                üí∞ Total do Investimento: ${formatarValor(valorTotal)}
                            </p>
                            <p class="text-dia-sorte-600">
                                ${generatedGames.length} jogos √ó ${numerosPorJogo} n√∫meros √ó ${formatarValor(precoPorJogo)} cada
                            </p>
                        </div>
                        <p class="text-dia-sorte-600 mb-4">
                            Use os bot√µes de download abaixo para obter seus jogos:
                        </p>
                    </div>
                `;
            } else if (generatedGames.length > 1000) {
                container.innerHTML = `
                    <div class="text-center p-4 bg-dia-sorte-50 border border-dia-sorte-300 rounded-lg mb-4">
                        <p class="text-dia-sorte-800 font-bold mb-2">
                            üìä ${generatedGames.length.toLocaleString()} jogos gerados! Exibindo apenas os primeiros 50.
                        </p>
                        <p class="text-dia-sorte-600 text-sm">Use os bot√µes de download para obter todos os jogos.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6" id="gamesGrid"></div>
                    <div class="bg-dia-sorte-100 border border-dia-sorte-300 rounded-lg p-4 text-center">
                        <p class="text-lg font-bold text-dia-sorte-800 mb-2">
                            üí∞ Total do Investimento: ${formatarValor(valorTotal)}
                        </p>
                        <p class="text-dia-sorte-600">
                            ${generatedGames.length} jogos √ó ${numerosPorJogo} n√∫meros √ó ${formatarValor(precoPorJogo)} cada
                        </p>
                    </div>
                `;
                
                const gamesGrid = document.getElementById('gamesGrid');
                generatedGames.slice(0, 50).forEach(game => {
                    const card = createGameCard(game, precoPorJogo);
                    gamesGrid.appendChild(card);
                });
            } else {
                container.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6" id="gamesGrid"></div>
                    <div class="bg-dia-sorte-100 border border-dia-sorte-300 rounded-lg p-4 text-center">
                        <p class="text-lg font-bold text-dia-sorte-800 mb-2">
                            üí∞ Total do Investimento: ${formatarValor(valorTotal)}
                        </p>
                        <p class="text-dia-sorte-600">
                            ${generatedGames.length} jogos √ó ${numerosPorJogo} n√∫meros √ó ${formatarValor(precoPorJogo)} cada
                        </p>
                    </div>
                `;
                
                const gamesGrid = document.getElementById('gamesGrid');
                generatedGames.forEach(game => {
                    const card = createGameCard(game, precoPorJogo);
                    gamesGrid.appendChild(card);
                });
            }
            
            section.classList.remove('hidden');
        }

        function createGameCard(game, preco) {
            const card = document.createElement('div');
            
            if (game.tipo === 'original') {
                card.className = 'bg-gradient-to-br from-dia-sorte-100 to-dia-sorte-200 border-2 border-dia-sorte-500 rounded-lg p-4';
            } else {
                card.className = 'bg-white border-2 border-dia-sorte-300 rounded-lg p-4';
            }
            
            let typeBadge = '';
            if (game.tipo === 'original') {
                typeBadge = '<span class="bg-dia-sorte-500 text-white px-2 py-1 rounded-full text-xs font-bold">üéØ ORIGINAL</span>';
            } else {
                const ajusteSymbol = game.ajuste > 0 ? '+' : '';
                typeBadge = `<span class="bg-blue-500 text-white px-2 py-1 rounded-full text-xs font-bold">üìà AJUSTADO (${ajusteSymbol}${game.ajuste})</span>`;
            }
            
            const allDigits = game.numeros.flatMap(n => n.toString().split(''));
            const uniqueDigits = [...new Set(allDigits)];
            const digitCount = uniqueDigits.length;
            
            card.innerHTML = `
                <div class="text-center mb-3">
                    <div class="font-bold text-dia-sorte-800 mb-2">
                        <i class="fas fa-ticket-alt"></i> Jogo ${game.jogo}
                    </div>
                    ${typeBadge}
                </div>
                <div class="flex flex-wrap justify-center gap-1 mb-3">
                    ${game.numeros.map(num => `
                        <span class="bg-dia-sorte-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold shadow-sm">
                            ${num}
                        </span>
                    `).join('')}
                </div>
                <div class="text-center">
                    <div class="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm font-semibold mb-2">
                        ${game.mesSorte}
                    </div>
                    <div class="text-xs text-dia-sorte-600 mb-2">
                        ${digitCount} d√≠gitos √∫nicos
                    </div>
                    <div class="text-sm font-bold text-dia-sorte-800">
                        ${formatarValor(preco)}
                    </div>
                </div>
            `;
            
            return card;
        }

        // =================== √öLTIMOS RESULTADOS ===================
        function renderUltimosResultados() {
            const container = document.getElementById('ultimosResultados');
            container.innerHTML = ultimosConcursos.map((concurso, index) => {
                const proximoNumero = concurso.numero + 1;
                const proximaData = calcularProximaData(concurso.data);
                const premioEstimado = calcularPremioEstimado(index);
                
                return `
                    <div class="bg-white border-2 border-dia-sorte-300 rounded-lg p-4 ${index === 0 ? 'border-dia-sorte-500' : ''}">
                        <div class="text-center mb-3">
                            <h3 class="text-lg font-bold text-dia-sorte-800 mb-1">
                                ${index === 0 ? 'üèÜ ' : ''}Concurso ${concurso.numero}
                            </h3>
                            <div class="text-sm text-dia-sorte-600">
                                <i class="fas fa-calendar"></i> ${concurso.data} (${obterDiaSemana(concurso.data)})
                            </div>
                        </div>

                        <div class="flex flex-wrap justify-center gap-1 mb-3">
                            ${concurso.dezenas.map(numero => `
                                <div class="bg-dia-sorte-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold shadow-sm">
                                    ${numero}
                                </div>
                            `).join('')}
                        </div>

                        <div class="text-center mb-3">
                            <div class="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm font-semibold">
                                <i class="fas fa-calendar-alt"></i> ${concurso.mes}
                            </div>
                        </div>

                        <div class="border-t border-dia-sorte-200 pt-3">
                            <div class="text-center text-xs text-dia-sorte-600 mb-2">
                                <strong>Pr√≥ximo:</strong> Concurso ${proximoNumero}<br>
                                ${proximaData}
                            </div>
                            <div class="text-center text-sm font-bold text-dia-sorte-800">
                                Pr√™mio Estimado: ${formatarValor(premioEstimado)}
                            </div>
                        </div>

                        <div class="text-center mt-3">
                            <button onclick="usarResultado(${index})" 
                                    class="bg-dia-sorte-500 hover:bg-dia-sorte-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                <i class="fas fa-magic"></i> Usar n√∫meros
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function usarResultado(index) {
            const resultado = ultimosConcursos[index];
            if (!resultado) return;
            
            limparSelecao();
            
            const numeros = resultado.dezenas.map(n => parseInt(n));
            numeros.forEach(num => {
                const button = document.getElementById(`numero-${num}`);
                if (button && !button.disabled) {
                    numerosSelecionados.add(num);
                    button.classList.add('bg-dia-sorte-500', 'text-white', 'border-dia-sorte-500');
                    button.classList.remove('border-dia-sorte-300', 'bg-white', 'text-dia-sorte-700');
                }
            });
            
            document.getElementById('mesSorte').value = resultado.mes;
            
            updateSelectedCount();
            updateGenerateButton();
            updateDigitsInfo();
            updateTotalValue();
            mostrarMensagem('success', `‚úÖ N√∫meros do concurso ${resultado.numero} selecionados!`);
        }

        function calcularProximaData(dataAtual) {
            const data = new Date(dataAtual.split('/').reverse().join('-'));
            data.setDate(data.getDate() + 3);
            const dia = data.getDate().toString().padStart(2, '0');
            const mes = (data.getMonth() + 1).toString().padStart(2, '0');
            const ano = data.getFullYear();
            const diaSemana = obterDiaSemana(`${dia}/${mes}/${ano}`);
            return `${dia}/${mes}/${ano} (${diaSemana})`;
        }

        function obterDiaSemana(dataStr) {
            const [dia, mes, ano] = dataStr.split('/');
            const data = new Date(ano, mes - 1, dia);
            const diasSemana = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
            return diasSemana[data.getDay()];
        }

        function calcularPremioEstimado(index) {
            const premios = [400000, 150000, 1100000, 700000, 400000, 160000];
            return premios[index] || 300000;
        }

        // =================== AN√ÅLISE DETALHADA ===================
        function renderTabelaDetalhada() {
            if (todosConcursos.length === 0) {
                todosConcursos = gerarTodosConcursos();
            }
            aplicarFiltros();
        }

        function gerarTodosConcursos() {
            const meses = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            
            const concursos = [];
            const concursoAtual = dadosAPI.numero;
            
            for (let i = 0; i < 500; i++) {
                const numeroConcurso = concursoAtual - i;
                if (numeroConcurso <= 0) break;
                
                const data = gerarDataHistorica(i);
                const dezenas = gerarDezenasAleatorias();
                const mes = meses[Math.floor(Math.random() * meses.length)];
                
                if (i === 0) {
                    concursos.push({
                        numero: dadosAPI.numero,
                        data: dadosAPI.dataApuracao,
                        dezenas: dadosAPI.listaDezenas,
                        mes: dadosAPI.nomeTimeCoracaoMesSorte
                    });
                } else {
                    concursos.push({
                        numero: numeroConcurso,
                        data: data,
                        dezenas: dezenas,
                        mes: mes
                    });
                }
            }
            
            return concursos;
        }

        function gerarDataHistorica(diasAtras) {
            const hoje = new Date();
            const dataHistorica = new Date(hoje.getTime() - (diasAtras * 3 * 24 * 60 * 60 * 1000));
            const dia = dataHistorica.getDate().toString().padStart(2, '0');
            const mes = (dataHistorica.getMonth() + 1).toString().padStart(2, '0');
            const ano = dataHistorica.getFullYear();
            return `${dia}/${mes}/${ano}`;
        }

        function gerarDezenasAleatorias() {
            const numeros = [];
            while (numeros.length < 7) {
                const num = Math.floor(Math.random() * 31) + 1;
                if (!numeros.includes(num)) {
                    numeros.push(num);
                }
            }
            return numeros.sort((a, b) => a - b).map(n => n.toString().padStart(2, '0'));
        }

        function aplicarFiltros() {
            const loading = document.getElementById('loadingTabela');
            const container = document.getElementById('containerTabela');
            const infoResultados = document.getElementById('infoResultados');
            
            loading.classList.remove('hidden');
            container.classList.add('hidden');
            
            setTimeout(() => {
                const ordenacao = document.querySelector('input[name="ordenacao"]:checked').value;
                const quantidade = document.getElementById('quantidadeConcursos').value;
                
                let concursosFiltrados = [...todosConcursos];
                
                if (quantidade !== 'todos') {
                    const qtd = parseInt(quantidade);
                    concursosFiltrados = concursosFiltrados.slice(0, qtd);
                }
                
                if (ordenacao === 'crescente') {
                    concursosFiltrados.reverse();
                }
                
                renderTabelaComDados(concursosFiltrados);
                
                infoResultados.innerHTML = `
                    Exibindo ${concursosFiltrados.length} concursos de ${todosConcursos.length} total. 
                    Ordena√ß√£o: ${ordenacao === 'decrescente' ? 'Mais recentes primeiro' : 'Mais antigos primeiro'}.
                `;
                
                loading.classList.add('hidden');
                container.classList.remove('hidden');
            }, 1000);
        }

        function renderTabelaComDados(concursos) {
            const tbody = document.getElementById('tabelaAnaliseBody');
            
            tbody.innerHTML = concursos.map((concurso, index) => {
                const padraoInicio = calcularPadraoUnicoInicio(concurso.dezenas);
                const padraoFinal = calcularPadraoUnicoFinal(concurso.dezenas);
                const digitosUnicos = calcularDigitosUnicos(concurso.dezenas);
                const qtdDigitos = [...new Set(digitosUnicos.split(','))].length;
                const { pares, impares } = contarParesImpares(concurso.dezenas);
                const soma = calcularSoma(concurso.dezenas);
                const naoSairam = numerosQueNaoSairam(concurso.dezenas);

                return `
                    <tr class="border-b border-dia-sorte-200 text-dia-sorte-700 hover:bg-dia-sorte-50" id="linha-${concurso.numero}">
                        <td class="border border-dia-sorte-300 p-2 text-center font-semibold text-dia-sorte-800">${concurso.numero}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center">${concurso.data}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center">
                            <div class="flex flex-wrap justify-center gap-1">
                                ${concurso.dezenas.map(num => `
                                    <span class="bg-dia-sorte-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">${num}</span>
                                `).join('')}
                            </div>
                        </td>
                        <td class="border border-dia-sorte-300 p-2 text-center">${concurso.mes}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-mono text-xs">${padraoInicio}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-mono text-xs">${padraoFinal}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-mono text-xs">${digitosUnicos}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-semibold">${qtdDigitos}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-semibold text-blue-600">${pares}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-semibold text-red-600">${impares}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center font-bold text-dia-sorte-600">${soma}</td>
                        <td class="border border-dia-sorte-300 p-2 text-xs" style="max-width: 200px; word-wrap: break-word;">${naoSairam}</td>
                        <td class="border border-dia-sorte-300 p-2 text-center">
                            <button onclick="toggleLinha(${concurso.numero})" class="bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded text-xs">
                                <span id="btn-${concurso.numero}">-</span>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function calcularPadraoUnicoInicio(dezenas) {
            const primeirosDigitos = [...new Set(dezenas.map(d => parseInt(d).toString()[0]))];
            return primeirosDigitos.sort().join(',');
        }

        function calcularPadraoUnicoFinal(dezenas) {
            const ultimosDigitos = [...new Set(dezenas.map(d => {
                const num = parseInt(d);
                return num >= 10 ? num.toString()[1] : num.toString()[0];
            }))];
            return ultimosDigitos.sort().join(',');
        }

        function calcularDigitosUnicos(dezenas) {
            const todosDigitos = [];
            dezenas.forEach(d => {
                const num = parseInt(d);
                if (num >= 10) {
                    todosDigitos.push(num.toString()[0], num.toString()[1]);
                } else {
                    todosDigitos.push('0', num.toString());
                }
            });
            return [...new Set(todosDigitos)].sort().join(',');
        }

        function contarParesImpares(dezenas) {
            let pares = 0, impares = 0;
            dezenas.forEach(d => {
                const num = parseInt(d);
                if (num % 2 === 0) pares++;
                else impares++;
            });
            return { pares, impares };
        }

        function calcularSoma(dezenas) {
            return dezenas.reduce((soma, d) => soma + parseInt(d), 0);
        }

        function numerosQueNaoSairam(dezenasDoSorteio) {
            const numerosSorteados = dezenasDoSorteio.map(d => parseInt(d));
            const todosNumeros = Array.from({length: 31}, (_, i) => i + 1);
            return todosNumeros.filter(num => !numerosSorteados.includes(num))
                .map(n => n.toString().padStart(2, '0')).join(', ');
        }

        function toggleLinha(numeroConcurso) {
            const linha = document.getElementById(`linha-${numeroConcurso}`);
            const botao = document.getElementById(`btn-${numeroConcurso}`);
            
            if (linha.style.display === 'none') {
                linha.style.display = '';
                botao.textContent = '-';
            } else {
                linha.style.display = 'none';
                botao.textContent = '+';
            }
        }

        function exportarCSV() {
            const loading = document.getElementById('loadingTabela');
            const ordenacao = document.querySelector('input[name="ordenacao"]:checked').value;
            const quantidade = document.getElementById('quantidadeConcursos').value;
            
            loading.classList.remove('hidden');
            
            setTimeout(() => {
                let concursosParaExportar = [...todosConcursos];
                
                if (quantidade !== 'todos') {
                    const qtd = parseInt(quantidade);
                    concursosParaExportar = concursosParaExportar.slice(0, qtd);
                }
                
                if (ordenacao === 'crescente') {
                    concursosParaExportar.reverse();
                }
                
                let csvContent = 'Concurso,Data,Dezenas,M√™s da Sorte,Padr√£o In√≠cio,Padr√£o Final,D√≠gitos √önicos,Qtd D√≠gitos,Pares,√çmpares,Soma,N√∫meros que n√£o sa√≠ram\n';
                
                concursosParaExportar.forEach(concurso => {
                    const padraoInicio = calcularPadraoUnicoInicio(concurso.dezenas);
                    const padraoFinal = calcularPadraoUnicoFinal(concurso.dezenas);
                    const digitosUnicos = calcularDigitosUnicos(concurso.dezenas);
                    const qtdDigitos = [...new Set(digitosUnicos.split(','))].length;
                    const { pares, impares } = contarParesImpares(concurso.dezenas);
                    const soma = calcularSoma(concurso.dezenas);
                    const naoSairam = numerosQueNaoSairam(concurso.dezenas);
                    
                    csvContent += `${concurso.numero},${concurso.data},"${concurso.dezenas.join('-')}",${concurso.mes},"${padraoInicio}","${padraoFinal}","${digitosUnicos}",${qtdDigitos},${pares},${impares},${soma},"${naoSairam}"\n`;
                });
                
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `dia-de-sorte-analise-${quantidade}-${ordenacao}.csv`;
                a.click();
                URL.revokeObjectURL(url);
                
                loading.classList.add('hidden');
            }, 1500);
        }

        // =================== DOWNLOADS ===================
        function downloadTXT() {
            if (generatedGames.length === 0) {
                mostrarMensagem('error', '‚ùå Nenhum jogo foi gerado ainda!');
                return;
            }
            
            let content = "";
            generatedGames.forEach(game => {
                content += `${game.numeros.join(' ')}\n`;
            });
            
            downloadFile(content, 'jogos_dia_de_sorte.txt', 'text/plain');
            mostrarMensagem('success', 'üìÑ Arquivo TXT baixado!');
        }

        function downloadHTML() {
            if (generatedGames.length === 0) {
                mostrarMensagem('error', '‚ùå Nenhum jogo foi gerado ainda!');
                return;
            }
            
            let html = `
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meus Jogos do Dia de Sorte</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fcf9e8, #f9f2d2);
            margin: 0;
            padding: 20px;
            color: #2d2606;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: #9f8514;
        }
        .info {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #d4b31a;
        }
        .game {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9cb49;
            text-align: center;
        }
        .game-title {
            font-weight: bold;
            color: #9f8514;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .numbers {
            margin: 15px 0;
        }
        .number {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            background: #d4b31a;
            color: white;
            border-radius: 50%;
            margin: 0 5px;
            font-weight: bold;
        }
        .month {
            background: #ccab19;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-weight: bold;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #887211;
            font-style: italic;
        }
        @media print {
            body { background: white; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üçÄ MEUS JOGOS DO DIA DE SORTE üçÄ</h1>
    </div>
    
    <div class="info">
        <p><strong>Data de Gera√ß√£o:</strong> ${new Date().toLocaleString('pt-BR')}</p>
        <p><strong>Total de Jogos:</strong> ${generatedGames.length}</p>
    </div>
    
    ${generatedGames.map(game => `
        <div class="game">
            <div class="game-title">üé´ Jogo ${game.jogo} ${game.tipo === 'original' ? '(Original)' : `(Ajustado ${game.ajuste > 0 ? '+' : ''}${game.ajuste})`}</div>
            <div class="numbers">
                ${game.numeros.map(num => `<span class="number">${num}</span>`).join('')}
            </div>
            <div class="month">${game.mesSorte}</div>
        </div>
    `).join('')}
    
    <div class="footer">
        <p>Gerado por: <strong>Sistema Completo do Dia de Sorte</strong></p>
        <p>üçÄ Boa sorte em todos os sorteios! üçÄ</p>
    </div>
</body>
</html>`;
            
            downloadFile(html, 'jogos_dia_de_sorte.html', 'text/html');
            mostrarMensagem('success', 'üåê Arquivo HTML baixado!');
        }

        function downloadXLSX() {
            if (generatedGames.length === 0) {
                mostrarMensagem('error', '‚ùå Nenhum jogo foi gerado ainda!');
                return;
            }
            
            const data = [
                ['JOGOS DO DIA DE SORTE - SISTEMA COMPLETO'],
                [`Data de Gera√ß√£o: ${new Date().toLocaleString('pt-BR')}`],
                [`Total de Jogos: ${generatedGames.length}`],
                [''],
                ['Jogo', 'Tipo', 'N√∫mero 1', 'N√∫mero 2', 'N√∫mero 3', 'N√∫mero 4', 'N√∫mero 5', 'N√∫mero 6', 'N√∫mero 7', 'M√™s da Sorte']
            ];
            
            generatedGames.forEach(game => {
                data.push([
                    `Jogo ${game.jogo}`,
                    game.tipo === 'original' ? 'Original' : `Ajustado (${game.ajuste > 0 ? '+' : ''}${game.ajuste})`,
                    ...game.numeros,
                    game.mesSorte
                ]);
            });
            
            data.push(['']);
            data.push(['Gerado por: Sistema Completo do Dia de Sorte']);
            data.push(['Boa sorte! üçÄ']);
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            const colWidths = [
                {wch: 12}, {wch: 15}, 
                {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10},
                {wch: 15}
            ];
            ws['!cols'] = colWidths;
            
            XLSX.utils.book_append_sheet(wb, ws, "Jogos Dia de Sorte");
            XLSX.writeFile(wb, 'jogos_dia_de_sorte.xlsx');
            mostrarMensagem('success', 'üìä Arquivo XLSX baixado!');
        }

        function copiarJogos() {
            if (generatedGames.length === 0) {
                mostrarMensagem('error', '‚ùå Nenhum jogo foi gerado ainda!');
                return;
            }
            
            const texto = generatedGames.map((game, i) => 
                `Jogo ${game.jogo}: ${game.numeros.join(', ')} - M√™s: ${game.mesSorte}`
            ).join('\n');
            
            navigator.clipboard.writeText(texto).then(() => {
                mostrarMensagem('success', 'üìã Jogos copiados para a √°rea de transfer√™ncia!');
            }).catch(() => {
                mostrarMensagem('error', '‚ùå Erro ao copiar. Tente baixar o arquivo TXT.');
            });
        }

        // =================== SISTEMA DE PRE√áOS EDIT√ÅVEIS ===================
        
        // Objeto para armazenar pre√ßos din√¢micos
        let precosAtuais = {
            7: 2.50, 8: 20.00, 9: 90.00, 10: 300.00, 11: 825.00,
            12: 1980.00, 13: 4290.00, 14: 8580.00, 15: 16087.50
        };

        // Multiplicadores baseados em combina√ß√µes matem√°ticas
        const multiplicadoresCombinacoes = {
            7: 1,    // C(7,7) = 1
            8: 8,    // C(8,7) = 8  
            9: 36,   // C(9,7) = 36
            10: 120, // C(10,7) = 120
            11: 330, // C(11,7) = 330
            12: 792, // C(12,7) = 792
            13: 1716,// C(13,7) = 1716
            14: 3432,// C(14,7) = 3432
            15: 6435 // C(15,7) = 6435
        };

        function updateAllPrices() {
            const valorBase = parseFloat(document.getElementById('basePrice').value) || 2.50;
            
            // Calcular todos os pre√ßos baseado no valor de 7 n√∫meros
            for (let qtd = 7; qtd <= 15; qtd++) {
                const novoPreco = valorBase * multiplicadoresCombinacoes[qtd];
                precosAtuais[qtd] = novoPreco;
                
                // Atualizar na interface
                const elementoPreco = document.getElementById(`price-${qtd}`);
                if (elementoPreco) {
                    elementoPreco.textContent = formatarValor(novoPreco);
                }
            }
            
            // Atualizar o c√°lculo do total
            updateTotalValue();
            
            // Mostrar notifica√ß√£o apenas se houve mudan√ßa significativa
            const precoAnterior = 2.50 * multiplicadoresCombinacoes[8]; // Valor padr√£o para 8 n√∫meros
            const precoNovo = valorBase * multiplicadoresCombinacoes[8];
            
            if (Math.abs(precoAnterior - precoNovo) > 0.01) {
                mostrarMensagem('success', `üí∞ Pre√ßos atualizados! Novo valor base: ${formatarValor(valorBase)}`);
            }
        }

        function resetBasePrice() {
            document.getElementById('basePrice').value = '2.50';
            updateAllPrices();
            mostrarMensagem('info', 'üîÑ Pre√ßos restaurados para os valores padr√£o da Caixa');
        }

        // =================== FUN√á√ïES AUXILIARES ===================
        function downloadFile(content, fileName, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            link.click();
            
            setTimeout(() => {
                URL.revokeObjectURL(link.href);
            }, 100);
        }

        function formatarValor(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        function mostrarMensagem(tipo, texto) {
            const mensagem = document.getElementById('mensagemSelecao');
            mensagem.classList.remove('hidden', 'bg-green-100', 'bg-yellow-100', 'bg-red-100', 'bg-blue-100', 'text-green-800', 'text-yellow-800', 'text-red-800', 'text-blue-800', 'border-green-200', 'border-yellow-200', 'border-red-200', 'border-blue-200');
            
            if (tipo === 'success') {
                mensagem.classList.add('bg-green-100', 'text-green-800', 'border-green-200', 'border');
            } else if (tipo === 'warning') {
                mensagem.classList.add('bg-yellow-100', 'text-yellow-800', 'border-yellow-200', 'border');
            } else if (tipo === 'error') {
                mensagem.classList.add('bg-red-100', 'text-red-800', 'border-red-200', 'border');
            } else {
                mensagem.classList.add('bg-blue-100', 'text-blue-800', 'border-blue-200', 'border');
            }
            
            mensagem.innerHTML = `<p class="text-sm">${texto}</p>`;
            
            setTimeout(() => {
                mensagem.classList.add('hidden');
            }, 5000);
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #22c55e, #16a34a)' : 
                             type === 'error' ? 'linear-gradient(135deg, #ef4444, #dc2626)' : 
                             'linear-gradient(135deg, #D4B31A, #e9cb49)'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 16px rgba(0,0,0,0.2);
                z-index: 10000;
                font-weight: 600;
                animation: slideInRight 0.3s ease;
                max-width: 300px;
            `;
            notification.textContent = message;
            
            if (!document.getElementById('notification-style')) {
                const style = document.createElement('style');
                style.id = 'notification-style';
                style.textContent = `
                    @keyframes slideInRight {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        function showConfirmDialog(message) {
            return new Promise((resolve) => {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.7);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 99999;
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                `;
                
                const dialog = document.createElement('div');
                dialog.style.cssText = `
                    background: white;
                    padding: 30px;
                    border-radius: 12px;
                    max-width: 500px;
                    width: 90%;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    border: 3px solid #d4b31a;
                `;
                
                dialog.innerHTML = `
                    <div style="text-align: center; margin-bottom: 25px;">
                        <h3 style="color: #9f8514; margin-bottom: 15px; font-size: 1.4rem;">‚ö†Ô∏è Confirma√ß√£o Necess√°ria</h3>
                        <p style="color: #2d2606; line-height: 1.6; white-space: pre-line; font-size: 1rem;">${message}</p>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 15px;">
                        <button id="cancelBtn" style="
                            background: #e74c3c;
                            color: white;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 1rem;
                            font-weight: 600;
                            transition: all 0.3s ease;
                        ">‚ùå Cancelar</button>
                        <button id="confirmBtn" style="
                            background: #d4b31a;
                            color: white;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 1rem;
                            font-weight: 600;
                            transition: all 0.3s ease;
                        ">‚úÖ Continuar</button>
                    </div>
                `;
                
                modal.appendChild(dialog);
                document.body.appendChild(modal);
                
                const cancelBtn = dialog.querySelector('#cancelBtn');
                const confirmBtn = dialog.querySelector('#confirmBtn');
                
                cancelBtn.addEventListener('click', () => {
                    document.body.removeChild(modal);
                    resolve(false);
                });
                
                confirmBtn.addEventListener('click', () => {
                    document.body.removeChild(modal);
                    resolve(true);
                });
                
                const keyHandler = (e) => {
                    if (e.key === 'Escape') {
                        document.body.removeChild(modal);
                        document.removeEventListener('keydown', keyHandler);
                        resolve(false);
                    }
                };
                document.addEventListener('keydown', keyHandler);
                
                cancelBtn.addEventListener('mouseenter', () => {
                    cancelBtn.style.background = '#c0392b';
                    cancelBtn.style.transform = 'translateY(-2px)';
                });
                cancelBtn.addEventListener('mouseleave', () => {
                    cancelBtn.style.background = '#e74c3c';
                    cancelBtn.style.transform = 'translateY(0)';
                });
                
                confirmBtn.addEventListener('mouseenter', () => {
                    confirmBtn.style.background = '#9f8514';
                    confirmBtn.style.transform = 'translateY(-2px)';
                });
                confirmBtn.addEventListener('mouseleave', () => {
                    confirmBtn.style.background = '#d4b31a';
                    confirmBtn.style.transform = 'translateY(0)';
                });
            });
        }

        // =================== MODAL DE INFORMA√á√ïES ===================
        function showInfoModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 99999;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                overflow-y: auto;
                padding: 20px;
            `;
            
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                background: white;
                border-radius: 15px;
                max-width: 800px;
                width: 95%;
                max-height: 90vh;
                overflow-y: auto;
                box-shadow: 0 15px 50px rgba(0,0,0,0.4);
                border: 3px solid #d4b31a;
                position: relative;
            `;
            
            dialog.innerHTML = `
                <div style="background: linear-gradient(135deg, #d4b31a, #e6c533); color: white; padding: 20px; border-radius: 12px 12px 0 0; text-align: center; position: relative;">
                    <button id="closeModal" style="
                        position: absolute;
                        top: 15px;
                        right: 20px;
                        background: rgba(255,255,255,0.2);
                        border: none;
                        color: white;
                        font-size: 1.5rem;
                        cursor: pointer;
                        border-radius: 50%;
                        width: 35px;
                        height: 35px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: all 0.3s ease;
                    ">√ó</button>
                    <h2 style="margin: 0; font-size: 1.8rem;">
                        <i class="fas fa-info-circle"></i> Sistema Completo do Dia de Sorte
                    </h2>
                    <p style="margin: 10px 0 0 0; opacity: 0.9;">A ferramenta mais avan√ßada para apostas profissionais</p>
                </div>
                
                <div style="padding: 30px; line-height: 1.6;">
                    
                    <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                            <i class="fas fa-rocket"></i> Principais Funcionalidades
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üéØ Sele√ß√£o Inteligente</strong><br>
                                <small>7 a 15 n√∫meros com estrat√©gias baseadas em dados reais</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üìà Ajustes Progressivos</strong><br>
                                <small>Sistema de varia√ß√£o autom√°tica dos n√∫meros</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üõ°Ô∏è Evitar Repeti√ß√µes</strong><br>
                                <small>Op√ß√£o para n√£o usar n√∫meros do √∫ltimo sorteio</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üß† 4 Estrat√©gias</strong><br>
                                <small>Frequentes, Atrasados, Padr√µes e Equilibrada</small>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                            <i class="fas fa-cogs"></i> Configura√ß√µes Avan√ßadas
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">‚öôÔ∏è</div>
                                <strong>Ajuste Progressivo</strong><br>
                                <small>‚Ä¢ Valores de -3 a +3<br>‚Ä¢ Aplicado progressivamente<br>‚Ä¢ Cria varia√ß√µes inteligentes</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">üß†</div>
                                <strong>Estrat√©gias</strong><br>
                                <small>‚Ä¢ Frequentes: Top 10<br>‚Ä¢ Atrasados: Menos sa√≠dos<br>‚Ä¢ Padr√µes: Estat√≠sticos</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">üí∞</div>
                                <strong>Pre√ßos Din√¢micos</strong><br>
                                <small>‚Ä¢ R$ 2,50 a R$ 16.087,50<br>‚Ä¢ C√°lculo autom√°tico<br>‚Ä¢ Investimento total</small>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #27ae60, #229954); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                            <i class="fas fa-download"></i> Exporta√ß√£o Completa
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">üìÑ</div>
                                <strong>Formato TXT</strong><br>
                                <small>Apenas n√∫meros, formato limpo</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">üåê</div>
                                <strong>Formato HTML</strong><br>
                                <small>Visual bonito para impress√£o</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">üìä</div>
                                <strong>Formato XLSX</strong><br>
                                <small>Planilha completa e organizada</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; margin-bottom: 10px;">üìã</div>
                                <strong>Copiar Texto</strong><br>
                                <small>Direto para √°rea de transfer√™ncia</small>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                            <i class="fas fa-chart-line"></i> An√°lise Estat√≠stica Avan√ßada
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üìà Dados Hist√≥ricos</strong><br>
                                <small>‚Ä¢ 500+ concursos simulados<br>‚Ä¢ Padr√µes de d√≠gitos<br>‚Ä¢ An√°lise de frequ√™ncia</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üîç Filtros Inteligentes</strong><br>
                                <small>‚Ä¢ Ordena√ß√£o por data<br>‚Ä¢ Quantidade configur√°vel<br>‚Ä¢ Exporta√ß√£o CSV</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üìä Estat√≠sticas Detalhadas</strong><br>
                                <small>‚Ä¢ Pares vs √çmpares<br>‚Ä¢ Soma das dezenas<br>‚Ä¢ D√≠gitos √∫nicos</small>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; padding: 20px; border-radius: 10px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.3rem;">
                            <i class="fas fa-shield-alt"></i> Performance e Seguran√ßa
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üöÄ Sem Limites</strong><br>
                                <small>‚Ä¢ Gere quantos jogos precisar<br>‚Ä¢ Sistema otimizado<br>‚Ä¢ Confirma√ß√£o para grandes volumes</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üíæ API Real</strong><br>
                                <small>‚Ä¢ Dados da Caixa Econ√¥mica<br>‚Ä¢ √öltimos resultados<br>‚Ä¢ Fallback inteligente</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üì± Responsivo</strong><br>
                                <small>‚Ä¢ Funciona em qualquer dispositivo<br>‚Ä¢ Interface adaptativa<br>‚Ä¢ Tooltips informativos</small>
                            </div>
                        </div>
                    </div>
                    
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 0 0 12px 12px; text-align: center; border-top: 2px solid #e9ecef;">
                    <button onclick="document.body.removeChild(this.closest('.fixed'))" style="
                        background: linear-gradient(135deg, #d4b31a, #e6c533);
                        color: white;
                        border: none;
                        padding: 12px 30px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-size: 1.1rem;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    ">
                        <i class="fas fa-check"></i> Vamos Apostar!
                    </button>
                    <p style="margin: 15px 0 0 0; color: #6c757d; font-size: 0.9rem;">
                        <i class="fas fa-lightbulb"></i> Sistema desenvolvido para apostadores de todos os n√≠veis!
                    </p>
                </div>
            `;
            
            modal.appendChild(dialog);
            document.body.appendChild(modal);
            
            const closeBtn = dialog.querySelector('#closeModal');
            closeBtn.addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            const keyHandler = (e) => {
                if (e.key === 'Escape') {
                    document.body.removeChild(modal);
                    document.removeEventListener('keydown', keyHandler);
                }
            };
            document.addEventListener('keydown', keyHandler);

            closeBtn.addEventListener('mouseenter', () => {
                closeBtn.style.background = 'rgba(255,255,255,0.3)';
            });
            closeBtn.addEventListener('mouseleave', () => {
                closeBtn.style.background = 'rgba(255,255,255,0.2)';
            });
        }
    </script>
</body>
</html>